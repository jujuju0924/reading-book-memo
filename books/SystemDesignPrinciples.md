## WEBAPIとは
**Postでは登録するデータの識別番号を、データを受け取ったアプリケーション側が発行する**
- 登録を要求する側は事前にどのような識別体系でデータを管理するかを知らない
**Putでは登録を要求する側が一意の識別情報を指定する**
- 存在しない場合は新規に作成し、ステータスコード201を返す
**データの登録はできるだけPOSTで行うべき**
- アプリケーションの独立性が高くなり、将来の修正や拡張の影響を小さくできる
**400番台はリクエストを投げる側に問題**
**500番台はapiを提供する側で問題が起きた場合**
**APIはapplication programming interface**
**APIはアプリケーションをプログラミングするための手段**
**良いWEB APIとは組み立ての多様性を維持しつつ、組み立ての負担が増えすぎない適切な大きさの部品を用意すること**
## API成長のサイクル
- API原案の提示と意見交換
- 合意したAPIの開発
- テスト環境とドキュメントの自動生成
- フィードバック
- フィードバックを元にした改良
- 改良結果の確認
- 大きなAPIは仕様の検討も実装も検証も時間がかかる。
- 用途が明確で小さなAPIは、検討も実装も検証も簡単。
- 小さなWebAPIの設計原則は次
- 登録と参照を分ける
- リソース（データの塊）の単位を分ける
## API例
- 予約の登録 POST reservations レスポンスとして予約番号2345を返す
- 予約の確認 GET    reservations/2345 予約番号2345の内容を返す
## リソースの単位を分ける
- 小さなAPIの例
- 氏名 GET members/1234/name
- 性別 GET member/1234/gender
- 生年月日 GET members/1234/dataOfBirth
- 連絡先 GET members/1234/contactMethods
- 住所 GET members/1234/address
## 対象のリソースを限定したAPIの例
- 電話番号の変更 POST members/1234/contactMethods/telephone 
- 住所の変更  POST members/1234/address
## URIにバージョン番号を入れるという考え方もある
- http://api.example.com/v2/members
- APIを提供する側は、利用する側のアプリケーションを組み立てるための部品の提供に専念するのが、アプリケーション間の独立性を保つ良いAPI設計の進め方。
- WEBAPI設計で悩ましい問題が、元データのままでやりとりするのか、加工や計算の結果をやりとりするかの判断
## マスタ項目のコードと名称
- コードのみ
- 名称のみ
- コードと名称の両方
## 合計の計算
- 基本は合計計算のロジックをどちらのアプリケーションが管理すべきかで判断する。
- 合計の計算ルールがAPIを利用する側のアプリケーションに依存したロジックであれば、APIは基礎データだけを返し、APIを利用する側で計算する。
## 日付データの形式
- 日付と時刻は別の項目として扱うべき。
## コアとなる基本API
- 拡張API
- 個別対応API
- 進化しないAPIの場合と比べると進化するAPIの価値がはっきりしている。
- オブジェクト指向では良い設計は最初からは手に入らないことを前提にしている。
- 早い段階から実際にコードを書き、動かしてみながら改善を続けることが、良い設計に早く確実にたどり着くという考え方。
- １つのアプリケーションであれば、実装技術/実行環境/データベースを共有しているため、クラスの追加やロジックの移動は簡単にできる設計改善。
- マイクロサービスとして分割してしまうと、ある業務ロジックを別のマイクロサービスに移動することが適切であることに気づくことさえ難しくなる。
- WEBAPIはできるだけ単純なデータを機能に分割したほうが、修正や拡張がやりやすい。
- 属性情報をメタ情報も含めて扱いたい場合は、JSONだけでなくXMLも選択肢となる。
## XML
- 文章の構造を階層的な要素（タグ名）の体系で表現する
- 要素ごとに、id、description、sequenceなどの属性情報を追加できる
- 文章名/作者名/文章の説明/有効期限など、文書のメタ情報を記述できる
- 要素名や要素の属性を使って、特定の要素を抜き出す操作がやりやすい
## json
変数の名前/配列/マップというシンプルな表現手段しかない